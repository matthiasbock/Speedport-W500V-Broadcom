<HTML>

<HEAD>

<TITLE>LadenSichernLaden</TITLE>

<SCRIPT language="JavaScript" src="js_menu.txt" type="text/JavaScript"></SCRIPT>
<SCRIPT language="JavaScript" src="js_fade.txt" type="text/JavaScript"></SCRIPT>

<SCRIPT language="JavaScript">
<!--
var isTimeout = true ;
var wpswd_sleeptime = '<%ejGet(upload_w_setting_sleep)%>' ;
var pre_filename = '<%ejGet(upload_config_file_name)%>' ;

var progress = 0;
 
function start()
{
	if (isTimeout == true)
		startseite();
	return ;
}

function back()
{
	if (isTimeout == true)
		laden();
	return ;
}

function messageCheck()
{
	var len = document.F2.Passwd.value.length ;

        with (document.forms[0]){
                if(filename.value.length == 0) {
			alert("Bitte tragen Sie eine gültige Konfigurations-Datei ein!") ;
                        return false;
                }
		else
		{
			if (len > 12 || (len < 6 && len > 0)) 
			{
                        	alert("Falsches Passwort! Bitte versuchen Sie es erneut.");
				document.F2.Passwd.focus() ;
				return false;
			}

                        if (confirm("Möchten Sie das Aktualisieren fortsetzen?"))
                        {
                                alert("Nach dem Aktualisieren ist es möglich, dass das Gateway bis zu einer Minute nicht auf Befehle reagiert. \nDas ist normal. Schalten Sie das Gateway in dieser Zeit nicht aus.");
                                return true;
                        }
                }
        }
        return false;
}
                                                                                
function evaltF()
{
        return messageCheck();
}
 
function stVerz(){
   document.getElementById("c_verzoeg1").style.visibility='hidden';
   document.getElementById("c_verzoeg2").style.visibility='hidden';
  alert("Die Konfiguration wurde erfolgreich geladen.\n\n" +
        "Nach dem Klick auf 'OK' wird der Router neu gestartet.\n" +
        "Anschließend können Sie mit Passwort wieder in das\n" +
        "Konfigurationsprogramm einsteigen.");
  top.frames[2].location.href = "hcti_laden.htm";
}

function btnApply()
{
	if (isTimeout == false)
		return ;
        var evalRes = evaltF();
        if(evalRes==true){
                setTimeout("stVerz()", 63000);
                document.getElementById("c_verzoeg1").style.visibility='visible';
                document.getElementById("c_verzoeg2").style.visibility='visible';
  		  document.getElementById("t_but1").style.visibility='hidden';
  		  document.getElementById("t_but3").style.visibility='hidden';
  		  document.getElementById("t_but4").style.visibility='hidden';
		  
		  if (document.F2.Passwd.value.length == 0)
		  	document.forms[0].encryKey.value = 'XXXXXXXXXXXXXX' ;	// 14 'X' to replace NULL password
		  else
			document.forms[0].encryKey.value = document.F2.Passwd.value ;
		  
                document.forms[0].submit();
        }
        return;
}

function stBak(){
	   document.forms[0].filename.disabled = false ;
	   document.forms[0].filename.style.backgroundColor="#FFFFFF";
	   document.forms[1].Passwd.style.backgroundColor="#FFFFFF";
	   document.forms[1].Passwd.disabled=false;
	   document.forms[1].Passwd.value = "" ;
	   document.forms[1].Passwd.focus() ;
	   isTimeout = true ;
}

function frmLoad()
{
          alert("Falsches Passwort! Bitte versuchen Sie es erneut");
	   //document.forms[0].filename.value = pre_filename ;
	   document.forms[0].filename.disabled = true ;
	   document.forms[0].filename.style.backgroundColor="#D4D0C8";
	   document.forms[1].Passwd.style.backgroundColor="#D4D0C8";
	   document.forms[1].Passwd.disabled=true;
                                                                                                   
	isTimeout = false ;
       setTimeout("stBak()",wpswd_sleeptime);
}


//-->
</SCRIPT>

<LINK rel="stylesheet" href="style.css" type="text/css">

</HEAD>

<BODY onload='frmLoad()'>
<form method='post' ENCTYPE='multipart/form-data' action='updatesettings.cgi'>
<DIV id=c_Frame>

<DIV id=c_border>
<DIV id=c_pfad>Laden &amp; Sichern / Laden</DIV>
<DIV id=c_titel>Laden einer gesicherten Konfiguration</DIV>

<DIV id=c_std>
      <table border="0" cellpadding="0" cellspacing="2">
        <tr onmouseover=i_showElem(1) onmouseout=i_showElem(0)>
	  <input type="hidden" name="encryKey" value="nothing">
	  <td width="70">Dateiname:</td>
          <td ><input type="file" value="Durchsuchen" name="filename" size="30" maxlength="255"></td>
	 </form>
        </tr>
      </table>
</DIV>
<DIV id=c_last>
  <table border="0" cellpadding="0" cellspacing="2">
    <tr onmouseover=i_showElem(2) onmouseout=i_showElem(0)>
      <form name="F2">
        <td width="70">Passwort:</td>
        <td><input type="password" class="stylepwd" name="Passwd" size="12" maxlength="12"></td>
      </form>
    </tr>
  </table>
</DIV>




<DIV id=c_leer></DIV>
<DIV id=c_foot></DIV>
</DIV>

<DIV id=c_verzoeg1></DIV>
<DIV id=c_verzoeg2></DIV>

</DIV>

<DIV id=t_Frame>

<DIV id=t_but1 onclick=start() onmouseover=rahmen(1,1) onmouseout=rahmen(0,1)>&lt;&lt;&nbsp;&nbsp;&lt;&lt;</DIV>
<DIV id=t_but3 onclick=back() onmouseover=rahmen(1,3) onmouseout=rahmen(0,3)>Zur&uuml;ck &lt;&lt;</DIV>
<DIV id=t_but4 onclick=btnApply() onmouseover=rahmen(1,4) onmouseout=rahmen(0,4)>OK &lt;&lt;</DIV>

</DIV>

<DIV id=i_Frame>

  <DIV id=i_content>
    <h2>Laden einer gesicherten Konfiguration</h2>
    <p>Sie haben die Möglichkeit eine bereits gesicherte Konfiguration wieder zu laden. Mit Hilfe der Taste
    'Durchsuchen' können Sie die gewünschte Datei auswählen. Wenn Sie anschließend mit 'OK' bestätigen,
    werden die Daten übernommen.</p>
  </DIV>
  
  <DIV id=i_content1>
    <h2>Laden einer gesicherten Konfiguration</h2>
    <p><b>Dateiname</b><br>
    Geben Sie hier den Speicherort und den Namen der Konfigurations-Datei ein.</p>
  	<p>Alternativ können Sie Ihren PC nach der Datei durchsuchen.</p>
  </DIV>
  
  <DIV id=i_content2>
    <h2>Laden einer gesicherten Konfiguration</h2>
    <p><b>Passwort</b><br>
    Zu Ihrem Schutz wurden die Konfigurationsdaten mit einem Passwort gespeichert.</p>
    <p>Geben Sie hier das Passwort ein, das sie beim Sichern der Konfiguration angegeben haben.</p>
  </DIV>
  
</DIV>

</BODY>

</HTML>
